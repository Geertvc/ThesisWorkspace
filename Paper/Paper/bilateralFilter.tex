The Bilateral filter is introduced in ~\cite{710815}, some information can also be found in ~\cite{bilfilter}.
\\
As the name already suggests, a bilateral filter filters an image using two different inputs, the position of pixels and its intensity value.
The most important property and reason why the bilateral filter is used very often is that it preserves the edges in the image.
To understand the working of a bilateral filter, the concept of a Gaussian filter is explained first.

\subsection{Gaussian filter}
As an image has two dimensions, the 2D version of the gaussian filter will be explained, in fact this is simply the product of two one dimensional gaussians, one per direction.
The equation of a 2D Gaussian filter is defined as:

\begin{equation}
   g(x,y) = \frac{1}{2\pi\sigma^2}e^{-\frac{x^{2}+y^{2}}{2\sigma^{2}}}
\end{equation}

with x and y being the distance from the origin and $\sigma$ being the standard deviation of the Gaussian distribution.
The shape of a Gaussian filter being a 2D bell shaped function.
\\
When an image is filtered using a Gaussian filter, this will lead to blurred images as the values of each pixel will fade into the values of the surrounding pixels.


\subsection{Bilateral filter as two Gaussian filters}
A bilateral filter can be explained as being two Gaussian filters that filter in the spatial (the domain filter D) and in the intensity domain (the range filter R) respectively.

\begin{equation}
  \begin{aligned}
    D(x,y) &=& e^{-\frac{x^{2}+y^{2}}{2\sigma^{2}}} \\
    R(p_i, p_j) &=& e^{-\frac{f(p_i)^{2}+f(p_j)^{2}}{2\sigma^{2}}}
  \end{aligned}
\end{equation}

The domain filter uses the difference between the positions of the two pixels in both the horizontal direction (x) and the vertical direction (y). 
The range filter uses the intensity value (obtained by the image function $f$) of both pixels.
\\
We can now write down the equation to compute final value of a pixel filtered using a bilateral filter.

\begin{equation}
\begin{aligned}
   b(p_i) &=& k^{-1}\sum_{m=0}^{N-1} f(p_m)D(x,y)R(p_i,p_m) \\
   \text{with} \\
   k &=& \sum_{m=0}^{N-1} D(x,y)R(p_i,p_m)
\end{aligned}
\end{equation}

x and y are again the difference in the positions of the pixels $p_i$ and $p_m$ and N is the size of the neighboorhood taken into account for each pixel.
The value of the pixel is multiplied with the two filter weights and then summed over all the samples in the neighboorhood, the $k^{-1}$ term makes sure the filter does not introduce more intensity into the image.
A nice property of the bilateral filter is that when the variance of the range filter is set to infinity, the bilateral filter acts like a Gaussian filter.


\subsection{Cross Bilateral Filter}
The RPF algorithm that is described in the following section, is based on a more advanced version of a bilateral filter, called the cross bilateral filter.
A Cross bilateral filter does not only filter in the spatial and the intensity domain but adds another filtering function to the filter.
This added function is a function just like the image function and returns a value for each position in the image.
An example of this function are the world position at the first intersection point of the ray traced through that pixel, allthough other features like the normal are also suitable.
